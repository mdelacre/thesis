---
title: " "
output: 
  papaja::apa6_pdf:
    includes:
      extra_dependencies: ["float"]

header-includes:
  - \usepackage{float}
  - \usepackage{sectsty}
  - \usepackage{lscape}
  - \newcommand{\blandscape}{\begin{landscape}}
  - \newcommand{\elandscape}{\end{landscape}}
---

# Chapitre 5: les tests d'équivalence

Lorsqu'on applique un test d'hypothèse, l'hypothèse nulle la plus couramment définie est celle d'absence d'effet ou de différence entre les groupes [@nickerson_null_2000]. Il arrive également parfois que les chercheurs définissent un intervalle de valeur comme hypothèse nulle, mais le plus souvent, cet intervalle est borné par la valeur 0 [@nickerson_null_2000], on parle alors d'hypothèse unilatérale. Avec cette stratégie, le rejet de l'hypothèse nulle constitue un soutien en faveur de la présence d'un effet non nul, par contre, le non rejet de l'hypothèse nulle ne peut être interprété comme un soutien en faveur de l'absence d'effet. Pourtant, il arrive souvent que des chercheurs l'interprètent de la sorte (Anderson & Maxwell, 2016). @finch_reporting_2001, par exemple, ont reporté que parmis 150 articles publiés entre 1940 et 1999 dans le *JAP* (*Journal of Applied Psychology*), 38% interprétaient un résultat non significatif comme une acceptation de l'hypothès nulle. Plus récemment, @lakens_equivalence_2017 a noté que l'expression "pas d'effet" a été utilisée dans 108 articles publié dans *Social Psychological and Personality Science* avant août 2016 et que dans presque tous les cas, c'était sur base du non rejet de l'hypothèse nulle que cette conclusion était tirée. Cette erreur d'interprétation est également fréquemment commise dans le cadre des études de réplication. Anderson & Maxwell  (2016), par exemple, ont analysé 50 réplications d'études publiées en 2013 dans PsycINFO. Ils ont noté que 14 études affirmaient avoir obtenu des effets "nuls" (interprété comme un échec à la réplication), et tous l'ont fait sur base de l'acceptation d'une hypothèse nulle d'absence d'effet. C'est par exemple de cette manière qu'on été réalisées la plupart des tentatives de réplications de la célèbre étude de Bem (Ritchie, Wiseman & French, 2012, cités par ANderson & Maxell, 2016). 

A travers ce chapitre, notre premier objectif sera d'expliquer pourquoi interpréter le non rejet de l'hypothèse d'absence d'effet comme un soutien en faveur d'une absence d'effet n'est pas une bonne stratégie. Nous introduirons ensuite les tests d'équivalence qui permettent d'obtenir un soutien en faveur d'un effet jugé non pertinent, et plus particulièrement le TOST (Two One-sided test). Pour finir, nous présenterons un article dans lequel nous comparons le TOST à la *SGPV* (Second Generation P-value), une stratégie récemment développée par @blume_second-generation_2018.

## Limites de l'approche traditionnelle

Lorsqu'on teste une hypothèse nulle, il y a deux conclusions possibles: soit ont la rejette soit on ne la rejette pas. Si rejeter l'hypothèse nulle amène à conclure en faveur de l'hypothèse alternative, ne pas la rejeter ne permet pas de conclure en faveur de l'hypothèse nulle. Au mieux, cela nous montre que les données ne sont pas incompatibles avec l'hypothèse nulle, mais cela ne veut en aucun cas dire qu'elles ne sont compatibles avec aucune autre hypothèse.  Afin de l'illustrer, la Table 1 résume les résultats de simulations Monte Carlo pour un ensemble de 70 scénarios qui varient en fonction de la taille des échantillons ($n_j$) et de la différence entre les moyennes des deux populations dont sont extraits les échantillons ($\mu_1-\mu_2$). Pour chaque scénario, à 5000 reprises, nous avons généré une paire d'échantillons indépendants, réalisé un test $t$ de Student pour échantillons indépendants et extrait la $p$-valeur du test. Ensuite, nous avons calculé la proportion de $p$-valeurs supérieures à .05, nous amenant à ne pas rejeter l'hypothèse nulle lorsqu'on travaille avec un risque alpha de 5% [ce risque alpha étant communément accepté par la majorité des chercheurs, @meyners_equivalence_2012]. Cette proportion correspond au taux d'erreur de type II (communément appelé $\beta$). 

```{r "simu", fig.align='center', fig.cap=NULL,echo=FALSE,out.width="96%"}
knitr::include_graphics("D:/Documents/Github_projects/thesis/Chapitre 5/Illustration/Table 1.png")
#knitr::include_graphics("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre 5/Illustration/Table #1.png")
```

Dans la mesure où une vraie différence entre les moyennes de population existe pour l'ensemble des scénarios envisagés dans la Table 1, nous espérerions être en mesure de rejeter l'hypothèse nulle le plus souvent possible. Pourtant, pour plusieurs scénarios, le nombre d'itérations amenant à conclure au non rejet de l'hypothèse nulle est bien supérieur au nombre d'itérations amenant à conclure au rejet de l'hypothèse nulle, comme on peut le voir à travers les valeurs $\beta$ très élevées dans certains cas. Par exemple, avec 10 sujets par groupes et considérant $\sigma_1=\sigma_2=1$, on ne détectera pas une différence de moyenne de .1 dans près de 95% des cas. Avec 200 sujets par groupe, on ne détectera toujours pas cette différence dans 80% des cas. En présence d'un effet non nul, cela se justifie par un manque de puissance des tests réalisés, ce qui démontre bien qu'un non rejet de l'hypothèse nulle peut en fait signifier deux choses: soit qu'il n'y a vraiment pas de différence entre les moyennes des populations (ou autrement dit, que les différences observées sont dûes au hasard), soit que le test n'est pas suffisamment puissant pour détecter la différence. Or, le manque de puissance des tests est récurrent dans la littérature, comme tendent à le montrer diverses méta-analyses [voir par exemple @button_power_2013; @bakker_rules_2012; @funder_improving_2014].

Pour éviter d'interpréter un test peu puissant comme un soutien en faveur de l'hypothèse nulle, l'approche de la puissance est devenue l'approche par défaut dans les années 80 pour tester l'équivalence [@meyners_equivalence_2012]. A travers cette approche qui est restée très populaire [@quertemont_how_2011], dans un premier temps, on définit ce qu'on considère comme étant la plus petite valeur d'intérêt (en anglais, le "SESOI" pour "Smaller Effect Size of Interest"), c'est-à-dire la taille d'effet minimale requise pour considérer qu'un effet est pertinent. Ensuite, on estime la puissance de notre test à détecter un effet de cette taille\footnote{On parle d'estimation et non de mesure, car la puissance dépend de paramètres de population qu'on ne connait pas (Schuirmann,1987).}, et si cette estimation atteind une valeur jugée satisfaisante (en général, 80%), alors on considère que l'on peut interpréter le non rejet de l'hypothèse nulle d'absence d'effet comme soutien en faveur de l'équivalence [@quertemont_how_2011; @meyners_equivalence_2012; @schuirmann_comparison_1987]. L'idée sous-jacente est que si l'effet est au moins aussi grand que les limites de la zone d'équivalence, on devrait rejeter l'hypothèse nulle dans la majorité des cas. Par conséquent, un non rejet de l'hypothèse nulle devrait vraisemblablement signifier que l'effet n'atteint pas le SESOI et donc, que l'effet observé n'est pas pertinent. 

```{r "schuirman1", fig.align='center', fig.cap="Région d'équivalence pour l'approche de la puissance (zone grisée) et pour le TOST (zone hachurée), pour l'exemple où $|\\theta$|=20, n = 50 et $\\alpha=.05$",echo=FALSE,out.width="96%"}
# paramètres de départ
alpha <- .05
required_power <- .80
n <- 50
df <- 2*n-2
theta <- 20   

# Différences de moyennes testées 
theta1 <- -theta
theta2 <- theta
meandiff <- seq(theta1,theta2,.0001) # différence de moyennes

######  t critique  ######

## Valeur en deça de laquelle on va NRH0 pour l'approche de la puissance
t_crit <- qt(1-alpha/2,df) # on conclura au NRH0 si t < 2.228 
## Valeur au delà de laquelle on va conclure à l'équivalence avec le TOST
t_crit_TOST <- qt(1-alpha,df) # On conclut à l'équivalence  si l'IC à 1-2alpha est entièrement inclus 
                              # entre les limites de la zone d'équivalence (d'où "1-alpha" au lieu de "1-alpha/2")

######  SE maximum autorisé  ######

## Pour l'approche de la puissance: on n'interprétera un NRH0 comme "preuve" d'équivalence QUE SI on atteind

### une puissance minimale donnée (cf. required_power; e.g.: 80%). Compte tenu de cette contrainte, 
### quel sera le SE maximum autorisé?
library(pwr)
res <- pwr.t.test(n=n,sig.level=alpha,
                  power=required_power,
                  type="two.sample",
                  alternative="two.sided")
d_min <- res$d # taille d'effet standardisée qui permet d'atteindre la
               # puissance requise
S_max <- theta/d_min # d_min <- theta/S_max <--> S_max = theta/d_min
SE_max <- S_max*sqrt(2/n) # SE <- S*sqrt(2/N)

## Pour le TOST: jusqu'à quel SE pourra-t-on conclure à l'équivalence? 

### Pour rappel, IC autour de meandiff à (1-alpha)% = meandiff+-t_crit_TOST*SE
### Si meandiff = 0 (le meilleur des cas), t_crit_TOST*SE ne peut pas dépasser theta2 (=20)
### t_crit_TOST*SE < theta2 <--> SE < theta2/t_crit 
SE_max_TOST <- theta2/t_crit_TOST # 11.03472

######  SE critique  ######

## SE minimum qui amènera à conclure à NRH0, avec l'approche de la puissance

### En fonction de meandiff, le SE au delà duquel on conclura
### au NRH0 sera calculé comme suit:
crit_SE <- abs(meandiff)/t_crit # quand n1=n2=n
                                # t = meandiff/SE <--> SE = meandiff/t 
                                # avec SE = S*sqrt(2/n) et S = écart-type poolé
### Attenion: il faut garder à l'esprit la contrainte de la puissance (tout SE supérieure à "SE_max"
### N'amènera PAS à conclure au NRH0)

## SE maximum qui amènera à conclure à l'équivalence, avec le TOST

### Si -theta2 < meandiff < theta2, t_crit_TOST ne peut pas dépasser theta2-abs(meandiff)
##### ex.: si meandiff = 1, et que theta2 = 20, le demi intervalle de confiance ne 
##### peut pas valoir plus de 19 sinon la borne sup sortira de la zone d'équivalence.
##### idem si meandiff = -1.
#### t_crit_TOST*SE < theta2-abs(meandiff) <--> abs(meandiff) < theta2-t_crit_TOST*SE
# SE < [theta2-abs(meandiff)]/t_crit_TOST

crit_SE_TOST <- (theta2-abs(meandiff))/t_crit_TOST

# Représentation graphique:

setwd("D:/Documents/Github_projects/thesis/Chapitre 5/Illustration")
#setwd("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre 5/Illustration")
png("Fig1.png",width=1500,height=1500, units = "px", res = 300)
ylimsup <- round(SE_max*3/100,1)*100 # pour que la lim supérieure soit un multiple de 10
# valant approximativement le double du SE_max
plot(0,0,
     pch=19,cex=.01,ylim=c(0,ylimsup),xlim=c(theta1,theta2),col="white",
     bty="n",
     xlab=expression(paste(bar(X[1])," - ",bar(X[2]))),
     ylab=expression(paste("s ",sqrt(paste(2,"/n"))))
)
axis(2,at=0:ylimsup,labels=rep("",length(0:ylimsup)),col.ticks="grey")
axis(2,at=seq(0,ylimsup,5),labels=rep("",length(seq(0,ylimsup,5))),col.ticks="black")

# Partie qui se rapporte à l'approche de la puissance
SE_max_data<-max(crit_SE[crit_SE<=SE_max]) # dans le vecteur crit_SE, quel est celui qui  
                                           # se rapproche le plus du SE_max?
segments(0,crit_SE[meandiff==0],meandiff[crit_SE==SE_max_data],SE_max_data)
segments(meandiff[crit_SE==SE_max_data][1],SE_max_data,
         meandiff[crit_SE==SE_max_data][2],SE_max_data)
x <- c(meandiff[crit_SE==SE_max_data][1],0,meandiff[crit_SE==SE_max_data][2])
y <- c(SE_max_data,0,SE_max_data)
polygon(x, y,col="grey")

# Partie qui se rapporte au TOST
SE_max_dataTOST<-max(crit_SE_TOST[crit_SE_TOST<=SE_max_TOST]) # dans le vecteur crit_SE, quel est celui qui  
segments(theta1,0,theta2,0)
segments(theta1,0,0,SE_max_dataTOST)
segments(0,SE_max_dataTOST,theta2,0)
x <- c(theta1,0,theta2)
y <- c(0,SE_max_dataTOST,0)
polygon(x, y,density=20)

dev.off()
```

Bien que ce raisonnement puisse sembler tentant, de prime abord, il présente d'importantes limites. Via cette approche, la probabilité de détecter une absence d’effet va augmenter non seulement quand la taille des échantillons va diminuer (Seaman & Serlin, 1998; à condition de ne pas passer en deça de la puissance minimale requise), mais également quand l’erreur (la variabilité des scores au sein de chaque groupe) va augmenter [@meyners_equivalence_2012; @schuirmann_comparison_1987]. Ce dernier point est illustré au sein de la Figure \ref{fig:schuirman2}, dans le contexte de la comparaison de deux moyennes. Sur l'axe des abscisses, on représente différentes estimations de la différence de moyenne ($\bar{X_1}-\bar{X_2}$) et sur l'axe des ordonnées, la précision des estimations $\bar{X_1}-\bar{X_2}$ ($S\sqrt{\frac{2}{n}}$ correspond à l'estimation de l'erreur standard de $\bar{X_1}-\bar{X_2}$, avec $S$ étant l'écart-type poolé et $n$ la taille de chaque échantillon, lorsque les échantillons ont tous les deux la même taille et sont extraits de population ayant la même variance)\footnote{Par facilité, à l'instar de Schuirman (1987), on envisage le cas où les échantillons sont de même taille et que l'on suppose que la condition d'homogénéité des variances est respectée. Notons cependant que d'après Schuirman, ce raisonnement peut être généralisé aux scénarios où les deux échantillons n'ont pas la même taille et sont extraits de population n'ayant pas la même variance.}. Le triangle grisé représente l'ensemble des combinaisons estimation/précision qui vont amener à conclure à l'équivalence, avec l'approche de la puissance, lorsqu'on travaille avec des échantillons de taille 50, en acceptant un risque $\alpha$ de 5% et en exigeant une puissance minimale de 80% pour détecter une différence de 20 unités ($|\theta_j=20|,\;j=1,2$). Dans cet exemple, pour toutes les valeurs de $S\sqrt{\frac{2}{n}}$ supérieures à `r SE_max` aucune estimation de différence de moyennes ne permettra de conclure à l'équivalence (pas même 0) puisque la puissance du test à détecter une différence de 20 unités est inférieure à 80%.  Pour toutes les valeurs de $S\sqrt{\frac{2}{n}}$ inférieures à `r SE_max`, on constate que plus notre estimation de $\bar{X_1}-\bar{X_2}$ est précise (lorsqu'on se déplace du haut vers le bas, sur l'axe des ordonnées), plus l'estimation doit être proche de 0 pour pouvoir conclure à l'équivalence. Cette propriété, peu désirable, n'est pas partagée par les tests d'équivalence dont fait partie le TOST que nous allons décrire ci-dessous [@schuirmann_comparison_1987]. 


```{r "schuirman2", fig.align='center', fig.cap="Région d'équivalence pour l'approche de la puissance (zone grisée) et pour le TOST (zone hachurée), pour l'exemple où $|\\theta$|=20, n = 50 et $\\alpha=.05$",echo=FALSE,out.width="96%"}
knitr::include_graphics("D:/Documents/Github_projects/thesis/Chapitre 5/Illustration/Fig1.png")
#knitr::include_graphics("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre #5/Illustration/Fig1.png")
```




```{r "tauxbeta", echo=FALSE}

#simu_beta <- function(n){

#  mudiff <- seq(.1,1.9,.2)
#  NRH0 <- NULL
  
#  for(j in seq_len(length(mudiff))){

#    m2 <- mudiff[j]  
#    t <- NULL
#    pval <- NULL
    
#    for (i in seq_len(5000)){
#      G1 <- rnorm(n,0,1)
#      G2 <- rnorm(n,m2,1)
#      res <- t.test(G1,G2,var.equal=TRUE)
#      t <- c(t, res$statistic)  
#      pval <- c(pval,res $p.value)  
#    }

#    NRH0 <- c(NRH0,sum(pval>.05)/length(pval))
    
#}

# return(round(NRH0,3))
 
  
#}

#S1 <- simu_beta(10)
#S2 <- simu_beta(15)
#S3 <- simu_beta(20)
#S4 <- simu_beta(25)
#S5 <- simu_beta(50)
#S6 <- simu_beta(100)
#S7 <- simu_beta(200)

#df <- rbind(S1,S2,S3,S4,S5,S6,S7)
#colnames(df)=seq(.1,1.9,.2)
#rownames(df)=c(10,15,20,25,50,100,200)

#write.table(df,"df.txt",sep=";",dec=",")
```

## Les tests d'équivalence

Avec les tests d'équivalence, il n'est pas possible de démontrer qu'un effet vaille exactement zéro [@meyners_equivalence_2012]. Il est par contre possible de montrer que l'effet observé est suffisamment petit pour être jugé non pertinent. Or, cela peut s'avérer précieux dans de nombreuses situations, par exemple pour justifier la décision de regrouper plusieurs groupes de sujets ensemble [@rogers_using_1993], pour contrôler qu'il n'y ait pas de différence trop importante entre les groupes sur base de critères autres que le (ou les) facteur(s) d'intérêts en cas de quasi-expérience [Seaman & Serlin, 1998], pour falsifier une théorie qui prônerait en faveur d'un effet dépassant une certaine taille [@lakens_equivalence_2017, Anderson & Maxwell, 2016] *ou au contraire, pour démontrer qu'on obtient des résultats en ligne avec ceux d'une étude originale, en cas de réplication (en faisant un test d'équivalence sur la différence de tailles d'effets, Anderson & Maxwell, 2016)* --> Revoir ça car pas sûre d'avoir tout bien compris.

Le point de départ des tests d'équivalence est de définir $\theta_1$ et $\theta_2$, les limites inférieures et supérieures de la zone d'équivalence, cette dernière contenant l'ensemble des valeurs jugées trop petites pour être susceptibles de nous intéresser. Ces limites peuvent être exprimées soit dans l'unité des données brutes, soit en terme standardisé, mais doivent être définies avant la récolte des données (Anderson & Maxwell, 2016). Il existe ensuite plusieurs approches pour démontrer que l'effet observé se situe dans la zone d'équivalence [voir @meyners_equivalence_2012, par exemple]. Parmis celles-ci, une approche très simple est celle du *TOST* (pour "Two one-sided tests", @schuirmann_comparison_1987; @lakens_equivalence_2017)\footnote{il existe des alternatives au TOST qui sont très légèrement plus puissantes, mais le gain marginal en termes de puissance est contrebalancé par un niveau de complexité beaucoup plus élevé (Meyners, 2012).}. Le principe est de définir deux hypothèses nulles: la première est que l'effet observé est inférieur à la limite inférieure de la zone d'équivalence: $$H0_1: \theta < \theta_1, \; avec \; \theta_1 \neq 0$$ La deuxième est que l'effet observé est supérieur à la limite supérieure de la zone d'équivalence: $$H0_2: \theta > \theta_2, \; avec \; \theta_2 \neq 0$$ Lorsque les deux hypothèses nulle peuvent être simultanément rejetées, on peut conclure à l'équivalence (Seaman & Serlin, 1998). Cela équivaut, statistiquement parlant, à montrer que l'intervalle de confiance à $(1-2\times\alpha)\%$ est entièrement inclus dans la zone d'équivalence [Westlake, 1981, cité par Seaman & Serlin, 1998; 
@lakens_equivalence_2017]. Notons qu'il n'est pas nécessaire de reporter les résulats des deux tests unilatéraux, lorsqu'on réalise le TOST: il suffit de reporter les résultats du test associé à la plus petite valeur de statistique (et par conséquent, à la plus grande $p$-valeur). En effet, si ce test amène à conclure au rejet de l'hypothèse nulle, le second test amènera automatiquement à la même conclusion [@rogers_using_1993, @lakens_equivalence_2018]. Cette remarque reste vraie dans le cas particulier où les deux tests sont associés à la même valeur de statistique puisque dans ce cas, les deux tests mèneront à une conclusion identique [@rogers_using_1993]. Notons également qu'il n'est pas nécessaire de procéder à une correction du risque alpha dûe à la réalisation simultanée de deux tests. En effet, une erreur de type I (rejeter à tort l'hypothèse nulle) ne peut être commise que si l'hypothèse nulle est vraie. Or, les deux hypothèses nulles testées sont mutuellement exclusives: il n'est pas possible que $\theta$ soit simultanément inférieur à $\theta_1$ (ce qui correspond à $H0_1$) et supérieur à $\theta_2$ (ce qui correspond à $H0_2$).  

Bien que le TOST ne soit pas encore disponible dans tous les logiciels, 
Lorsqu'on utilise simultanément le TOST et le test traditionnel d'absence d'effet, 4 conclusions distinctes peuvent être tirées des résultats [@lakens_equivalence_2017]. 

```{r, include=FALSE}
library(TOSTER)
m <- 144.5
mu <- 144.5
sd <- 500
n <- 1000000
low_eqbound = -2 
high_eqbound = 2 
alpha = 0.05
tost_res1 <- TOSTone.raw(m = m, 
                   mu = mu,
                   sd = sd, 
                   n = n, 
                   low_eqbound = low_eqbound, 
                   high_eqbound = high_eqbound, 
                   alpha = alpha
)

m <- 143
mu <- 144.5

sd <- 500
n <- 1000000
low_eqbound = -2 
high_eqbound = 2 
alpha = 0.05
tost_res2 <- TOSTone.raw(m = m, 
                   mu = mu,
                   sd = sd, 
                   n = n, 
                   low_eqbound = low_eqbound, 
                   high_eqbound = high_eqbound, 
                   alpha = alpha
)
m <- 147
mu <- 144.5
sd <- 500
n <- 1000000
low_eqbound = -2 
high_eqbound = 2 
alpha = 0.05
tost_res3 <- TOSTone.raw(m = m, 
                   mu = mu,
                   sd = sd, 
                   n = n, 
                   low_eqbound = low_eqbound, 
                   high_eqbound = high_eqbound, 
                   alpha = alpha
)
```

```{r "equiv1", fig.align = "center", fig.cap= "Différence de moyennes ($\\bar{X_1}-\\bar{X_2}$), distribution d'échantillonnage et IC à $1-2\\alpha\\%$ autour de la différence de moyennes ($\\bar{X_1}-\\bar{X_2}$) pour 3 exemples de TOST.", echo=FALSE, dpi=600, fig.width=5, fig.height=4}
plot(NA, 
     ylim = c(0, 1), 
     xlim = c(-3, 4),
     yaxt = "n",
     xaxt= "n",
     ylab = "",
     xlab = "Mean Difference")
axis(2, at = c(0.25,0.5,0.75), labels = c("C", "B", "A"), las = 1)
axis(1, at = c(-2,0,2), labels = c(expression(theta[1]),0,expression(theta[2])),las = 1)
abline(v = tost_res1$high_eqbound, 
       lty = 2)
abline(v = tost_res1$low_eqbound, 
       lty = 2)
abline(v = 0, 
       lty = 2, 
       col = "grey")
points(x = tost_res3$diff, 
       y = 0.25, 
       pch = 15, 
       cex = 1.5)
segments(tost_res3$LL_CI_TOST, 
         0.25, 
         tost_res3$UL_CI_TOST, 
         0.25, 
         lwd = 2)
points(x = tost_res2$diff, 
       y = 0.5, 
       pch = 15, 
       cex = 1.5)
segments(tost_res2$LL_CI_TOST, 
         0.5, 
         tost_res2$UL_CI_TOST, 
         0.5, 
         lwd = 2)
points(x = tost_res1$diff, 
       y = 0.75, 
       pch = 15, 
       cex = 1.5)
segments(tost_res1$LL_CI_TOST, 
         0.75, 
         tost_res1$UL_CI_TOST, 
         0.75, 
         lwd = 2)

par(new=TRUE)
curve(dnorm(x, 144.5 - 144.5, 0.5), from=-1, to=1, ylim = c(-6, 2), xlim = c(-3, 4), xlab = "", ylab = "", axes = FALSE)
par(new=TRUE)
curve(dnorm(x, 143 - 144.5, 0.5), from=-2.5, to=-0.5, ylim = c(-4, 4), xlim = c(-3, 4), xlab = "", ylab = "", axes = FALSE)
par(new=TRUE)
curve(dnorm(x, 147 - 144.5, 0.5), from=1.5, to=3.5, ylim = c(-2, 6), xlim = c(-3, 4), xlab = "", ylab = "", axes = FALSE)
```



## Avantage des tests d'équivalence

## Conclusions possibles

1) statistical indeterminacy [@quertemont_how_2011]
2) equivalence [@quertemont_how_2011]

Lorsqu'ils sont combinés avec un test traditionnel pour lequel l'hypothèse nulle est l'absence d'effet, les TOST peuvent amener à 4 conclusions distinctes:
1) Equivalent et non statistiquement différent de 0: on conclura à l'absence de différence ayant un intérêt pratique [@rogers_using_1993].
2) Statistiquement différent de 0, mais équivalent: il existe un effet non nul, mais trop petit pour avoir un intérêt. C'est ce qui peut typiquement arriver avec des échantillons trop larges (résultant en des tests "trop "puissants, @rogers_using_1993)  
3) Statistiquement différent de 0, et on ne peut conclure à l'équivalence: on conclura alors à la présence d'un effet [@rogers_using_1993]
4) Ni statistiquement différent de 0 ni équivalent (quand les données sont si imprécises qu'on ne peut rien tirer comme conclusion)  
--> A illustrer quand Jamovi le voudra!


## Définir les limites de la zone d'équivalence:LE sesoi

L'aspect le plus compliqué dans la réalisation du TOST est la définition des bornes d'équivalence. Il existe plusieurs stratégies:  
1) définir comme limites la plus petite taille d'effet pour laquelle on peut atteindre une puissance de détection suffisante (déterminé par les ressources disponibles pour étudier l'effet, @lakens_equivalence_2017) --> voir la section "Setting equivalence bounds" p. 359 mais je crois que j'en parle aussi dans la vidéo SOCLAB.  
2) le SESOI peut parfois être fixé objectivement 
3) Idéalement basé sur une analyse coût-bénéfice). Attention: bien sûr une dimension subjective dans la définition des coûts et des bénéfices. 
Attention: le SESOI doit être déterminé AVANT et INDEPENDAMMENT des données. 

## Les 4 conclusions possibles quand combiné au NHST classique

Voir @lakens_equivalence_2017 p. 357. J'en parle ou po?


## Morceau qui servira peut-être (ou pas)

D'après @lakens_practical_2021, un test d'hypothèse (selon l'approche de Nayman-Pearson) vaut la peine à 2 conditions:  
1) que l'hypothèse nulle soit assez plausible pour que son rejet puisse surprendre au moins certains;  
2) le chercheur veut appliquer une procédure méthodol qui l'autorise à prendre des décisions quant à la manière d'agir, tout en contrôlant le taux d'erreur. Agir peut vouloir dire: adopter un traitement, une politique, une intervention, ou abandonner un domaine de rechercher, modifier une manipulation, ou de faire un certain type de déclaration ou revendication.  
*One of the most widely suggested improvements of the use of p values is to replace null-ypothesis tests (where the goal is to reject ann effect of exactly 0) with tests of range predictions (where the goal is to reject effects that fall outside of the range of effects that is predicted or considered practically important) [@lakens_practical_2021]. 

Un autre argument en défaveur de la p-valeur est la tendance des chercheurs à interpréter un effet NS comme l'acceptation de l'hypothèse nulle (Schmidt, 1996, cité par Harris, 1997). Une fois encore, l'usage des tailles d'effet peut aider à cette fin, non pas en "remplaçant" les tests d'hypothèses, mais en les complétant. --> Tests d'équivalence. 

## Remarques diverses

D'après Meyners, il existe pleins d'approches mais la différence entre elles est souvent négligeable [@meyners_equivalence_2012].







```{r "chp5p1", fig.align='center', fig.cap=NULL,echo=FALSE,out.width="92%"}
knitr::include_graphics("D:/Documents/Github_projects/thesis/Chapitre 5/Chapitre 5-1.png")
#knitr::include_graphics("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre 5/Chapitre 5-1.png")
```

```{r "chp5p2", fig.align='center', fig.cap=NULL,echo=FALSE}
knitr::include_graphics("D:/Documents/Github_projects/thesis/Chapitre 5/Chapitre 5-2.png")
#knitr::include_graphics("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre 5/Chapitre 5-2.png")
```

```{r "chp5p3", fig.align='center', fig.cap=NULL,echo=FALSE}
knitr::include_graphics("D:/Documents/Github_projects/thesis/Chapitre 5/Chapitre 5-3.png")
#knitr::include_graphics("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre 5/Chapitre 5-3.png")
```

```{r "chp5p4", fig.align='center', fig.cap=NULL,echo=FALSE}
knitr::include_graphics("D:/Documents/Github_projects/thesis/Chapitre 5/Chapitre 5-4.png")
#knitr::include_graphics("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre 5/Chapitre 5-4.png")
```

```{r "chp5p5", fig.align='center', fig.cap=NULL,echo=FALSE}
knitr::include_graphics("D:/Documents/Github_projects/thesis/Chapitre 5/Chapitre 5-5.png")
#knitr::include_graphics("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre 5/Chapitre 5-5.png")
```

```{r "chp5p6", fig.align='center', fig.cap=NULL,echo=FALSE}
knitr::include_graphics("D:/Documents/Github_projects/thesis/Chapitre 5/Chapitre 5-6.png")
#knitr::include_graphics("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre 5/Chapitre 5-6.png")
```

```{r "chp5p7", fig.align='center', fig.cap=NULL,echo=FALSE}
knitr::include_graphics("D:/Documents/Github_projects/thesis/Chapitre 5/Chapitre 5-7.png")
#knitr::include_graphics("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre 5/Chapitre 5-7.png")
```

```{r "chp5p8", fig.align='center', fig.cap=NULL,echo=FALSE}
knitr::include_graphics("D:/Documents/Github_projects/thesis/Chapitre 5/Chapitre 5-8.png")
#knitr::include_graphics("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre 5/Chapitre 5-8.png")
```

```{r "chp5p9", fig.align='center', fig.cap=NULL,echo=FALSE}
knitr::include_graphics("D:/Documents/Github_projects/thesis/Chapitre 5/Chapitre 5-9.png")
#knitr::include_graphics("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre 5/Chapitre 5-9.png")
```

```{r "chp5p10", fig.align='center', fig.cap=NULL,echo=FALSE}
knitr::include_graphics("D:/Documents/Github_projects/thesis/Chapitre 5/Chapitre 5-10.png")
#knitr::include_graphics("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre 5/Chapitre 5-10.png")
```

```{r "chp5p11", fig.align='center', fig.cap=NULL,echo=FALSE}
knitr::include_graphics("D:/Documents/Github_projects/thesis/Chapitre 5/Chapitre 5-11.png")
#knitr::include_graphics("C:/Users/Admin/OneDrive/Documents/Github projects/thesis/Chapitre 5/Chapitre 5-10.png")
```


